2023-06-28 12:27:52,798 [MainThread  ] [INFO ]  Starting main function
2023-06-28 12:27:52,798 [MainThread  ] [INFO ]  Parameters:
2023-06-28 12:27:52,798 [MainThread  ] [INFO ]   SoccerNet_path : ../../Data/
2023-06-28 12:27:52,798 [MainThread  ] [INFO ]         features : ResNET_TF2_PCA512.npy
2023-06-28 12:27:52,798 [MainThread  ] [INFO ]       max_epochs : 500
2023-06-28 12:27:52,798 [MainThread  ] [INFO ]     load_weights : None
2023-06-28 12:27:52,798 [MainThread  ] [INFO ]       model_name : TCA_t40_th0.3
2023-06-28 12:27:52,798 [MainThread  ] [INFO ]        test_only : False
2023-06-28 12:27:52,799 [MainThread  ] [INFO ]      split_train : ['train']
2023-06-28 12:27:52,799 [MainThread  ] [INFO ]      split_valid : ['valid']
2023-06-28 12:27:52,799 [MainThread  ] [INFO ]       split_test : ['test']
2023-06-28 12:27:52,799 [MainThread  ] [INFO ]          version : 2
2023-06-28 12:27:52,799 [MainThread  ] [INFO ]      feature_dim : None
2023-06-28 12:27:52,799 [MainThread  ] [INFO ]  evaluation_frequency : 10
2023-06-28 12:27:52,799 [MainThread  ] [INFO ]        framerate : 2
2023-06-28 12:27:52,799 [MainThread  ] [INFO ]      window_size : 20
2023-06-28 12:27:52,799 [MainThread  ] [INFO ]             pool : TCA
2023-06-28 12:27:52,799 [MainThread  ] [INFO ]     vlad_cluster : 64
2023-06-28 12:27:52,800 [MainThread  ] [INFO ]       NMS_window : 40
2023-06-28 12:27:52,800 [MainThread  ] [INFO ]    NMS_threshold : 0.3
2023-06-28 12:27:52,800 [MainThread  ] [INFO ]       batch_size : 256
2023-06-28 12:27:52,800 [MainThread  ] [INFO ]               LR : 0.001
2023-06-28 12:27:52,800 [MainThread  ] [INFO ]              LRe : 1e-06
2023-06-28 12:27:52,800 [MainThread  ] [INFO ]         patience : 10
2023-06-28 12:27:52,800 [MainThread  ] [INFO ]              GPU : 3
2023-06-28 12:27:52,800 [MainThread  ] [INFO ]   max_num_worker : 4
2023-06-28 12:27:52,800 [MainThread  ] [INFO ]             seed : 0
2023-06-28 12:27:52,800 [MainThread  ] [INFO ]         loglevel : INFO
2023-06-28 12:27:52,802 [MainThread  ] [INFO ]  Checking/Download features and labels locally
2023-06-28 12:27:53,825 [MainThread  ] [INFO ]  Pre-compute clips
2023-06-28 12:28:27,250 [MainThread  ] [INFO ]  Checking/Download features and labels locally
2023-06-28 12:28:27,594 [MainThread  ] [INFO ]  Pre-compute clips
2023-06-28 12:28:38,451 [MainThread  ] [INFO ]  Checking/Download features and labels locally
2023-06-28 12:28:38,724 [MainThread  ] [INFO ]  Pre-compute clips
2023-06-28 12:28:55,750 [MainThread  ] [INFO ]  Checking/Download features and labels locally
2023-06-28 12:29:02,324 [MainThread  ] [INFO ]  Model(
  (pool_layer_before): NetVLAD()
  (pool_layer_after): NetVLAD()
  (fc): Linear(in_features=32768, out_features=18, bias=True)
  (drop): Dropout(p=0.4, inplace=False)
  (sigm): Sigmoid()
)
2023-06-28 12:29:02,325 [MainThread  ] [INFO ]  Total number of parameters: 655378
2023-06-28 12:29:02,326 [MainThread  ] [INFO ]  start training
2023-06-28 12:32:10,975 [MainThread  ] [INFO ]  Validation performance at epoch 11 -> 0.3335255974443864
2023-06-28 12:35:04,649 [MainThread  ] [INFO ]  Validation performance at epoch 21 -> 0.3785044834444045
2023-06-28 12:38:01,371 [MainThread  ] [INFO ]  Validation performance at epoch 31 -> 0.39931146761529696
2023-06-28 12:41:00,078 [MainThread  ] [INFO ]  Validation performance at epoch 41 -> 0.4110434244689486
2023-06-28 12:44:05,790 [MainThread  ] [INFO ]  Validation performance at epoch 51 -> 0.4184339297637264
2023-06-28 12:46:57,936 [MainThread  ] [INFO ]  Validation performance at epoch 61 -> 0.421947623336579
2023-06-28 12:49:35,352 [MainThread  ] [INFO ]  Validation performance at epoch 71 -> 0.4266731848519271
2023-06-28 12:49:50,030 [MainThread  ] [INFO ]  Plateau Reached!
2023-06-28 12:52:07,787 [MainThread  ] [INFO ]  Validation performance at epoch 81 -> 0.4272273154351355
2023-06-28 12:53:05,836 [MainThread  ] [INFO ]  Plateau Reached!
2023-06-28 12:54:36,900 [MainThread  ] [INFO ]  Validation performance at epoch 91 -> 0.4277821892598555
2023-06-28 12:55:48,302 [MainThread  ] [INFO ]  Plateau Reached!
2023-06-28 12:57:04,271 [MainThread  ] [INFO ]  Validation performance at epoch 101 -> 0.4280942200746838
2023-06-28 12:58:32,639 [MainThread  ] [INFO ]  Plateau Reached!
2023-06-28 12:59:34,141 [MainThread  ] [INFO ]  Validation performance at epoch 111 -> 0.4280819598685051
2023-06-28 13:01:16,531 [MainThread  ] [INFO ]  Plateau Reached!
2023-06-28 13:02:04,999 [MainThread  ] [INFO ]  Validation performance at epoch 121 -> 0.4280828245721177
2023-06-28 13:03:47,946 [MainThread  ] [INFO ]  Plateau Reached and no more reduction -> Exiting Loop
2023-06-28 13:03:48,071 [MainThread  ] [INFO ]  Checking/Download features and labels locally
2023-06-28 13:08:18,408 [MainThread  ] [INFO ]  Best Performance at end of training 
2023-06-28 13:08:18,408 [MainThread  ] [INFO ]  a_mAP visibility all: 0.47576867458718125
2023-06-28 13:08:18,409 [MainThread  ] [INFO ]  a_mAP visibility all per class: [0.620949765761429, 0.5792143551763747, 0.7009412541242636, 0.6672216950208537, 0.3210930723798574, 0.3083635939735298, 0.3098102439946682, 0.4968700369716011, 0.6518002886748545, 0.5826170885145866, 0.5935318577917592, 0.3694383485384383, 0.5084880457226362, 0.7753926513408914, 0.4618393022277445, 0.14049586776859505, 0.0]
2023-06-28 13:08:18,409 [MainThread  ] [INFO ]  a_mAP visibility visible: 0.5020491385939275
2023-06-28 13:08:18,409 [MainThread  ] [INFO ]  a_mAP visibility visible per class: [0.6655878742190726, 0.6520261553508883, 0.7110217531739335, 0.7252644033287944, 0.33746878033992744, 0.3108134398153983, 0.31187139777174616, 0.6285510079111681, 0.6584243085173068, 0.6208415943270027, 0.596003015281281, 0.3260171301491489, 0.574086338671204, 0.7814092478278685, 0.4949530416434312, 0.14049586776859505, 0.0]
2023-06-28 13:08:18,409 [MainThread  ] [INFO ]  a_mAP visibility unshown: 0.30694003923511776
2023-06-28 13:08:18,410 [MainThread  ] [INFO ]  a_mAP visibility unshown per class: [0.0, 0.530815768925977, 0.0, 0.2941231535812758, 0.1752295684113866, 0.0, 0.0, 0.37154504962097357, 0.5749441088493571, 0.4994691638545538, 0.3557488934419057, 0.43613390323369444, 0.0038602811330084056, 0.7012347620755262, 0.0471158569288723, 0.0, 0.0]
2023-06-28 13:08:18,410 [MainThread  ] [INFO ]  Total Execution Time is 2425.6127841472626 seconds
